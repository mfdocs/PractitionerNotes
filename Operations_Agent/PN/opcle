<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="0" style="border-left: none;">
 <tbody><tr>
  <td width="697" valign="top" style="width: 6.95in; border-width: 1pt; border-left-style: solid; border-color: black; border-image: initial; background: rgb(242, 242, 242); padding: 0in 5.4pt;">
  <h2><a name="_Toc491176789">OPC_LE_KEEP_DSCONNECTION</a><span class="LabelChar"><span style="font-size:12.0pt;line-height:107%;mso-bidi-font-family:
  Arial;font-weight:normal"><o:p></o:p></span></span></h2>
  </td>
 </tr>
 <tr>
  <td width="697" valign="top" style="width: 6.95in; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="0" style="border-left: none;">
   <tbody><tr>
    <td width="178" valign="top" style="width: 133.5pt; border-width: 1pt; border-left-style: solid; border-color: black; border-image: initial; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size:12.0pt;font-family:&quot;Calibri&quot;,sans-serif">Type</span><span style="font-size:12.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:black"><o:p></o:p></span></p>
    </td>
    <td width="504" valign="top" style="width: 5.25in; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: black; border-right-color: black; border-bottom-color: black; border-image: initial; border-left: none; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size: 12pt; font-family: Calibri, sans-serif;">Boolean<o:p></o:p></span></p>
    </td>
   </tr>
   <tr>
    <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size:12.0pt;font-family:&quot;Calibri&quot;,sans-serif">Default
    Value<o:p></o:p></span></p>
    </td>
    <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size: 12pt; font-family: Calibri, sans-serif;">FALSE<o:p></o:p></span></p>
    </td>
   </tr>
   <tr>
    <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size:12.0pt;font-family:&quot;Calibri&quot;,sans-serif">Class
    of the variable<o:p></o:p></span></p>
    </td>
    <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size: 12pt; font-family: Calibri, sans-serif;">Opcle<o:p></o:p></span></p>
    </td>
   </tr>
   <tr>
    <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size:12.0pt;font-family:&quot;Calibri&quot;,sans-serif">Namespace
    <o:p></o:p></span></p>
    </td>
    <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size: 12pt; font-family: Calibri, sans-serif;">Eaagt<o:p></o:p></span></p>
    </td>
   </tr>
   <tr>
    <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
    <p class="MsoNormal"><b><span style="font-size:12.0pt;line-height:107%">Restart Required<o:p></o:p></span></b></p>
    </td>
    <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size: 12pt; font-family: Calibri, sans-serif;">Yes<o:p></o:p></span></p>
    </td>
   </tr>
   <tr>
    <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
    <p class="MsoNormal"><b><span style="font-size:12.0pt;line-height:107%">I<span style="color:black">ntroduced
    since</span>&nbsp; <o:p></o:p></span></b></p>
    </td>
    <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size: 12pt; font-family: Calibri, sans-serif;">OA A.08.10<o:p></o:p></span></p>
    </td>
   </tr>
   <tr>
    <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
    <p class="MsoNormal"><b><span style="font-size:12.0pt;line-height:107%">Applicable Platforms<o:p></o:p></span></b></p>
    </td>
    <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size: 12pt; font-family: Calibri, sans-serif;">Only Windows<o:p></o:p></span></p>
    </td>
   </tr>
   <tr>
    <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
    <p class="MsoNormal"><b><span style="font-size:12.0pt;line-height:107%">Related variables<o:p></o:p></span></b></p>
    </td>
    <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
    <p class="Label"><span style="font-size: 12pt; font-family: Calibri, sans-serif; color: windowtext;">OPC_LE_REPLACE_DSNAMES<o:p></o:p></span></p>
    </td>
   </tr>
  </tbody></table>
  <p class="Label"><span style="font-family: Arial, sans-serif;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="697" valign="top" style="width: 6.95in; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; background: rgb(242, 242, 242); padding: 0in 5.4pt;">
  <p class="MsoNormal"><b><span style="font-size:12.0pt;line-height:107%">Short description</span></b><span style="font-size:12.0pt;line-height:107%;mso-bidi-font-family:Arial"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style="mso-yfti-irow:3;height:55.75pt">
  <td width="697" valign="top" style="width: 6.95in; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt; height: 55.75pt;">
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">On the Windows node,
  opcle locks the 1025 and 1026 ports toward the primary domain controller
  (PDC) emulator. If set to TRUE, the connection is kept open as long as opcle
  runs. If set to FALSE, the<o:p></o:p></span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">Connection is closed
  after each request to unlock the port.</span></p>
  </td>
 </tr>
 <tr>
  <td width="697" valign="top" style="width: 6.95in; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; background: rgb(242, 242, 242); padding: 0in 5.4pt;">
  <p class="MsoNormal"><b><span style="font-size:12.0pt;line-height:107%">Long Description</span></b><span class="DetailsChar"><b><span style="font-size:12.0pt;line-height:107%;mso-bidi-font-family:Arial"><o:p></o:p></span></b></span></p>
  </td>
 </tr>
 <tr style="mso-yfti-irow:5;mso-yfti-lastrow:yes;height:107.5pt">
  <td width="697" valign="top" style="width: 6.95in; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt; height: 107.5pt;">
  <p class="MsoNoSpacing"><b><u><span style="font-size:12.0pt">What is PDC</span></u></b><span style="font-size:
  12.0pt"> : Detailed info about PDC could be found in below KB doc from
  Microsoft : <span class="MsoHyperlink"><a href="https://support.microsoft.com/en-in/kb/197132">https://support.microsoft.com/en-in/kb/197132</a></span><o:p></o:p></span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">&nbsp;</span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">OPC_LE_KEEP_DSCONNECTION
  mentions whether connection to the PDC emulator should stay established or
  temporary.&nbsp; If itâ€™s set to TRUE then it
  implies established connection to PDC via port 1025 and 1026. Advantage of
  established connection is faster performance.<o:p></o:p></span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">But the same ports 1025
  and 1026 is also used for the domain controller replication, therefore an
  established connection is not an option, if more than one domain controller
  are available within the domain.<o:p></o:p></span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">If Value of OPC_LE_REPLACE_DSNAMES
  is TRUE only then OPC_LE_KEEP_DSCONNECTION will be evaluated.<o:p></o:p></span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">&nbsp;</span></p>
  <p class="MsoNoSpacing"><b><u><span style="font-size:12.0pt">Use case :<o:p></o:p></span></u></b></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">When an event is read
  from the security event logs, opcle tries to resolve all the variables in the
  properties of the event. If there is variable of format %{GUID} and
  OPC_LE_REPLACE_DSNAMES is set to TRUE, we load Windows DLL ntdsapi.dll and
  call certain AD APIs to map the GUID to strings. This mapping is adding about
  1-2 seconds per event to the overall event processing time. If there are more
  such variables to be resolved in the property this takes a couple of more
  seconds.<o:p></o:p></span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">Due to this as the number
  of security events increases, the processing time of the events by 'opcle'
  process also increases. <o:p></o:p></span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">To tackle this we need
  to disable variable resolution in windows event logs by setting OPC_LE_REPLACE_DSNAMES=FALSE
  in eaagt namespace.<o:p></o:p></span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">&nbsp;</span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">&nbsp;</span></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">&nbsp;</span></p>
  <p class="MsoNoSpacing"><b><u><span style="font-size:12.0pt">Scenario where OPC_LE_REPLACE_DSNAMES could help :<o:p></o:p></span></u></b></p>
  <p class="MsoNoSpacing" style="margin-left:.5in;text-indent:-.25in;mso-list:
  l0 level1 lfo1"><!--[if !supportLists]--><span style="font-size:12.0pt;
  mso-bidi-font-family:Calibri">1.<span style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span><!--[endif]--><u><span style="font-size:12.0pt">Alerts generated by Windows Eventlog policy arrives
  with huge and random time delays :<o:p></o:p></span></u></p>
  <p class="MsoNoSpacing"><span style="font-size:12.0pt">On Domain Controller
  machines opcle tries to resolve the variables in incoming event logs. That
  resolution might takes time and add up to latency for all subsequent alert
  generation. In such cases we can set OPC_LE_REPLACE_DSNAMES and OPC_LE_REPLACE_DSNAMES
  to FALSE. This will improve the performance for opcle while processing the
  event logs.<o:p></o:p></span></p>
  </td>
 </tr>
</tbody></table>