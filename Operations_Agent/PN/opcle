<h2>OPC_LE_KEEP_DSCONNECTION</h2><p class="MsoNormal"><o:p></o:p></p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="0" style="border-left: none;">
 <tbody><tr>
  <td width="178" valign="top" style="width: 133.5pt; border-width: 1pt; border-left-style: solid; border-color: black; border-image: initial; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style=""><b>Type</b></span><span lang="EN-US" style=""><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: black; border-right-color: black; border-bottom-color: black; border-image: initial; border-left: none; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">Boolean<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style=""><b>Default Value</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style=""><b>Class of the variable</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">opcle<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style=""><b>Namespace </b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">eaagt<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal"><span style="line-height: 107%;"><b>Restart Required</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">Yes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal"><span style="line-height: 107%;"><b>Introduced
  since&nbsp; </b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">OA A.08.10<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal"><span style="line-height: 107%;"><b>Applicable Platforms</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">Only Windows<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal"><span style="line-height: 107%;"><b>Related variables</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">OPC_LE_REPLACE_DSNAMES<font color="rgba(0, 0, 0, 0)" face="Calibri, sans-serif"><span style="font-size: 12pt;"><o:p></o:p></span></font></span></p>
  </td>
 </tr>
</tbody></table>

<h3><b>Short Description</b></h3><p class="MsoNormal"><o:p></o:p></p>

<p class="MsoNormal">On the Windows node, opcle locks the 1025 and 1026 ports
toward the primary domain controller (PDC) emulator. If set to TRUE, the
connection is kept open as long as opcle runs. If set to FALSE, the c<span style="font-size: inherit; letter-spacing: 0.2px; background-color: transparent;">onnection is closed after each request to unlock the port.</span></p><p class="MsoNormal"><o:p></o:p></p>

<h3><b>Long Description</b></h3><p class="MsoNormal"><o:p></o:p></p>

<p class="MsoNormal">What is PDC: Detailed info about PDC could be found in
below KB doc from Microsoft:<br><a href="https://support.microsoft.com/en-in/kb/197132" target="_blank">https://support.microsoft.com/en-in/kb/197132</a><br><o:p></o:p></p>

<p class="MsoNormal">OPC_LE_KEEP_DSCONNECTION mentions whether connection to the
PDC emulator should stay established or temporary.&nbsp; If itâ€™s set to TRUE then it implies
established connection to PDC via port 1025 and 1026. Advantage of established
connection is faster performance.<o:p></o:p></p>

<p class="MsoNormal">But the same ports 1025 and 1026 is also used for the domain
controller replication, therefore an established connection is not an option,
if more than one domain controller are available within the domain.<o:p></o:p></p>

<p class="MsoNormal">If Value of OPC_LE_REPLACE_DSNAMES is TRUE only then
OPC_LE_KEEP_DSCONNECTION will be evaluated.<o:p></o:p></p>

<p class="MsoNormal"><b>Use case:</b><o:p></o:p></p>

<p class="MsoNormal">When an event is read from the security event logs, opcle
tries to resolve all the variables in the properties of the event. If there is
variable of format %{GUID} and OPC_LE_REPLACE_DSNAMES is set to TRUE, we load
Windows DLL ntdsapi.dll and call certain AD APIs to map the GUID to strings.
This mapping is adding about 1-2 seconds per event to the overall event
processing time. If there are more such variables to be resolved in the
property this takes a couple of more seconds.<o:p></o:p></p>

<p class="MsoNormal">Due to this as the number of security events increases, the
processing time of the events by 'opcle' process also increases.&nbsp;<span style="font-size: inherit; letter-spacing: 0.2px; background-color: transparent;">To tackle this we need to disable variable resolution in
windows event logs by setting OPC_LE_REPLACE_DSNAMES=FALSE in eaagt namespace.</span></p><p class="MsoNormal"><o:p></o:p></p>

<p class="MsoNormal"><b>Scenario where OPC_LE_REPLACE_DSNAMES could help:</b><o:p></o:p></p>

<p class="MsoNormal">Alerts generated by Windows Eventlog policy arrives with
huge and random time delays</p><p class="MsoNormal"><span style="font-size: inherit; letter-spacing: 0.2px; background-color: transparent;">On Domain Controller machines opcle tries to resolve the
variables in incoming event logs. That resolution might takes time and add up
to latency for all subsequent alert generation. In such cases we can set
OPC_LE_REPLACE_DSNAMES and OPC_LE_REPLACE_DSNAMES to FALSE. This will improve
the performance for opcle while processing the event logs.</span></p><h2>OPC_LE_CALC_HASH</h2><p class="MsoNormal"><o:p></o:p></p><table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="0" style="border-left: none;">
 <tbody><tr>
  <td width="178" valign="top" style="width: 133.5pt; border-width: 1pt; border-left-style: solid; border-color: black; border-image: initial; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style=""><b>Type</b></span><span lang="EN-US" style=""><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: black; border-right-color: black; border-bottom-color: black; border-image: initial; border-left: none; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">Boolean<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style=""><b>Default Value</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">FALSE<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style=""><b>Class of the variable</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">opcle<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style=""><b>Namespace </b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">Eaagt<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal"><span style="line-height: 107%;"><b>Restart Required</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">Yes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal"><span style="line-height: 107%;"><b>Introduced
  since&nbsp; </b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">OA A.08.10<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal"><span style="line-height: 107%;"><b>Applicable Platforms</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">ALL<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="178" valign="top" style="width: 133.5pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal"><span style="line-height: 107%;"><b>Related variables</b><o:p></o:p></span></p>
  </td>
  <td width="504" valign="top" style="width: 5.25in; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span lang="EN-US" style="">OPC_LE_SAVE_STATE<font color="rgba(0, 0, 0, 0)" face="Calibri, sans-serif"><span style="font-size: 12pt;"><o:p></o:p></span></font></span></p>
  </td>
 </tr>
</tbody></table><h3><b>Short Description</b></h3><p class="MsoNormal"><o:p></o:p></p><p class="MsoNormal">If the value of OPC_LE_CALC_HASH is TRUE, opcle detects the
file is appended or overwritten by calculating hash of last line of log file.
If opcle detects the file is overwritten, then it reads the file from
beginning.<o:p></o:p></p><h3><b>Long Description</b></h3><p class="MsoNormal"><o:p></o:p></p><p class="MsoNormal">What is HASH: Hashing is a way to uniquely identify any
text/string/line. By calculating hash we can verify if any two
strings/lines/text are same or not.<o:p></o:p></p><p class="MsoNormal"><ul><li>The OPC_LE_SAVE_STATE variable should be set for the
OPC_LE_CALC_HASH to work, as the hash information is written to a file by
opcle.</li><li>Variable is applicable for both Static and Dynamic log file
monitoring. The save state file created in the node will have information about
the File name, Inode and the hash value.</li><li>If the inode is changed, then the file is always read from
beginning.</li><li>If the inode is same, then the hash value is calculated and
compared.</li></ul><o:p></o:p></p><p class="MsoNormal"><o:p></o:p></p><p class="MsoNormal"><o:p></o:p></p><p class="MsoNormal">

















</p><p class="MsoNormal"><o:p></o:p></p><p class="MsoNormal"><o:p></o:p></p>