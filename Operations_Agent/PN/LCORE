<h2><b>BBC Communication broker Connection Pool
Internals<o:p></o:p></b></h2><h1>

<p class="MsoNormal"><o:p>&nbsp;</o:p><span style="letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;"><font size="4">BBC Communication broker is the single central point of
entry to a node for all applications that uses the BBC API. All applications
that wish to receive messages needs to register an address with the CB.</font></span><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">&nbsp;</span></p>

<p class="MsoNormal"><font size="4">The local or remote applications may either query the BBC CB
for the location of the application or use the BBC CB as an HTTP proxy to
forward the request to the appropriate registered application.&nbsp; The process of establishing a connection from
one host to another is quite complex and involves multiple packet exchanges
between two endpoints, which can be quite time consuming.</font><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">&nbsp;</span></p>

<p class="MsoNormal"><font size="4">The BBC communication broker handles the HTTP requests
through a combination of a thread pool and a connection pool. Since these HTTP
connections are represented finally by sockets, a connection pool is nothing
but pool of sockets. In BBC terms it is known as Socket Set. The pool of
threads services the pool of sockets. The connections are either HTTP or HTTPS
connection based on whether certificate is installed or not. The default ratio
of the threads that handle the Http connections from the connection pool is
1:10; this is based on an assumption that at any point in time, 10 % of the
connections would be active and sending the requests to the server. The default
size of the Connection Pool and threads is 60 and 6 respectively.<o:p></o:p></font></p>

<p class="MsoNormal"><font size="4">This means that Connection pool that contains 60 connections
(to be more specific set of sockets) will be handled by 6 threads. Whenever a
request arrives on BBC communication broker, one of the threads which is
waiting on system calls select or poll,&nbsp;
will read the request and based on the url of the HTTP request it
invokes the handler and once the handling of the request is over , it joins
back the thread pool. If for example the no of connections exceeds 60 , which
is the default size of the socket set, a new socket set is created .This new
socket set would be served by yet another&nbsp;
new pool 6 threads(default value). A socket set and associated threads
would be released once all the sockets in the pool are closed.&nbsp; Please note that the Socket Set grows
linearly as the connections increase and there is no rebalancing to the socket
set once the sockets are closed. Hence it is possible to have multiple Sockets
sets which has multiple connections and in the worst case scenario where all
sockets are closed except one it is possible to have a socket set which has a
single socket and 6 threads catering to it. The socket set and associated
resources including thread pool will be cleared once the socket set is empty.
This is why in case of large number of connections tuning of SOCKETS_PER_SOCKETSET
and MAX_SOCKETSET_THREADS is important.<o:p></o:p></font></p>

<h1><o:p><font size="4">&nbsp;</font></o:p><span style="color: inherit; font-family: inherit; font-size: 18px; font-weight: 700; letter-spacing: 1.1px; text-transform: initial; background-color: transparent;">SocketPoll</span></h1></h1><h1><table class="MsoTableGrid" border="1" cellspacing="0" cellpadding="0" align="left" width="0" style="border-left: none; margin-left: 0.1in; margin-right: 0.1in;">
 <tbody><tr>
  <td width="230" valign="top" style="width: 172.25pt; border-width: 1pt; border-left-style: solid; border-color: black; border-image: initial; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size:12.0pt"><b>Type</b></span><span style="font-size:12.0pt;color:black"><o:p></o:p></span></p>
  </td>
  <td width="292" valign="top" style="width: 219pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: black; border-right-color: black; border-bottom-color: black; border-image: initial; border-left: none; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size: 12pt;">Boolean</span><span style="font-size: 12pt; color: black;"><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="230" valign="top" style="width: 172.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size:12.0pt"><b>Default Value</b><o:p></o:p></span></p>
  </td>
  <td width="292" valign="top" style="width: 219pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size: 12pt;">False<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="230" valign="top" style="width: 172.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size:12.0pt"><b>Class of the variable</b><o:p></o:p></span></p>
  </td>
  <td width="292" valign="top" style="width: 219pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size: 12pt;">Xpl<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="230" valign="top" style="width: 172.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size:12.0pt"><b>Namespace </b><o:p></o:p></span></p>
  </td>
  <td width="292" valign="top" style="width: 219pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size: 12pt;">xpl.net<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="230" valign="top" style="width: 172.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;mso-element:frame;mso-element-frame-hspace:9.0pt;mso-element-wrap:
  around;mso-element-anchor-vertical:page;mso-element-anchor-horizontal:margin;
  mso-element-top:107.45pt;mso-height-rule:exactly"><b><span style="font-size:12.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;
  mso-ascii-theme-font:major-latin;mso-fareast-font-family:Calibri;mso-hansi-theme-font:
  major-latin;mso-bidi-font-family:&quot;Times New Roman&quot;">Restart Required<o:p></o:p></span></b></p>
  </td>
  <td width="292" valign="top" style="width: 219pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size: 12pt;">Yes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="230" valign="top" style="width: 172.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;mso-element:frame;mso-element-frame-hspace:9.0pt;mso-element-wrap:
  around;mso-element-anchor-vertical:page;mso-element-anchor-horizontal:margin;
  mso-element-top:107.45pt;mso-height-rule:exactly"><b><span style="font-size:12.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;
  mso-ascii-theme-font:major-latin;mso-fareast-font-family:Calibri;mso-hansi-theme-font:
  major-latin;mso-bidi-font-family:&quot;Times New Roman&quot;">I<span style="color:black">ntroduced
  since</span>&nbsp; <o:p></o:p></span></b></p>
  </td>
  <td width="292" valign="top" style="width: 219pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size: 12pt;">LCore 6.X<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="230" valign="top" style="width: 172.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;mso-element:frame;mso-element-frame-hspace:9.0pt;mso-element-wrap:
  around;mso-element-anchor-vertical:page;mso-element-anchor-horizontal:margin;
  mso-element-top:107.45pt;mso-height-rule:exactly"><b><span style="font-size:12.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;
  mso-ascii-theme-font:major-latin;mso-fareast-font-family:Calibri;mso-hansi-theme-font:
  major-latin;mso-bidi-font-family:&quot;Times New Roman&quot;">Applicable Platforms <o:p></o:p></span></b></p>
  </td>
  <td width="292" valign="top" style="width: 219pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size: 12pt;">Linux and Solaris<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="230" valign="top" style="width: 172.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left: 1pt solid black; border-right-color: black; border-bottom-color: black; border-image: initial; border-top: none; padding: 0in 5.4pt;">
  <p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;mso-element:frame;mso-element-frame-hspace:9.0pt;mso-element-wrap:
  around;mso-element-anchor-vertical:page;mso-element-anchor-horizontal:margin;
  mso-element-top:107.45pt;mso-height-rule:exactly"><b><span style="font-size:12.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;
  mso-ascii-theme-font:major-latin;mso-fareast-font-family:Calibri;mso-hansi-theme-font:
  major-latin;mso-bidi-font-family:&quot;Times New Roman&quot;">Related variables<o:p></o:p></span></b></p>
  </td>
  <td width="292" valign="top" style="width: 219pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: black; border-right-width: 1pt; border-right-color: black; padding: 0in 5.4pt;">
  <p class="Label"><span style="font-size: 12pt;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table><p class="MsoNormal"><o:p>&nbsp;</o:p></p><p class="MsoNormal"><o:p>&nbsp;</o:p></p><p class="MsoNormal"><o:p>&nbsp;</o:p></p><p class="MsoNormal"><o:p>&nbsp;</o:p></p><p class="MsoNormal"><o:p>&nbsp;</o:p></p><h2><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">Short description</span></h2><p class="MsoNormal"><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">The poll and select are mechanisms used for I/O
multiplexing. The system call poll() is</span><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">&nbsp;
</span><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">non-blocking while select() is blocking.</span><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">&nbsp;
</span><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">This flag SocketPoll indicates whether to use poll() or select()</span><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">&nbsp; </span><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">system call while we are creating a server
socket there by making the socket non-blocking or blocking.</span><span style="font-size: large; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">While monitoring a large environment it is recommended to
set this variable to true.</span></p><p class="MsoNormal"><font size="4"><b>Long Description</b><o:p></o:p></font></p><p class="MsoNormal"><o:p><font size="4">



























</font></o:p></p><p class="MsoNormal"><font size="4">By default LCore module uses Select call while waiting for
input on sockets. This is much efficient in smaller environments where the
sockets it has wait for would be less than 1024. As the environments gets larger
with nodes more than 1024, it is better to use the Poll system call which is a
non-blocking call. For ex. ovbbccb is an Http Server implementation which by
default uses a select call for new connections. If the variable SocketPoll is
made to true, it no longer would use the Select but will start using Poll
instead.</font><o:p></o:p></p></h1><p class="MsoNormal"><o:p></o:p></p>