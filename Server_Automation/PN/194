<h2 id="Attach_a_new_ZIP_Unit_to_a_software_policy" style="color: rgb(0, 0, 0); letter-spacing: normal; text-transform: none; font-family: sans-serif;">Attach a new ZIP Unit to a software policy</h2><span class="anchor" id="line-1599" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><span class="anchor" id="line-1600" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><p class="line874" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;">The problem we need to workaround is that there is no addXXX method so we must fetch all the items, add our item to that list, then set it all back.<span class="anchor" id="line-1601"></span><span class="anchor" id="line-1602"></span><span class="anchor" id="line-1603"></span><span class="anchor" id="line-1604"></span><span class="anchor" id="line-1605"></span><span class="anchor" id="line-1606"></span><span class="anchor" id="line-1607"></span><span class="anchor" id="line-1608"></span><span class="anchor" id="line-1609"></span><span class="anchor" id="line-1610"></span><span class="anchor" id="line-1611"></span><span class="anchor" id="line-1612"></span><span class="anchor" id="line-1613"></span><span class="anchor" id="line-1614"></span><span class="anchor" id="line-1615"></span><span class="anchor" id="line-1616"></span><span class="anchor" id="line-1617"></span><span class="anchor" id="line-1-188"></span></p><div class="highlight python" style="color: rgb(0, 0, 0); font-family: sans-serif;"><div class="codearea" dir="ltr" lang="en" style="margin: 0.5em 0px; padding: 0px; border: 1pt solid rgb(174, 189, 204); background-color: rgb(243, 245, 247);"><pre dir="ltr" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc" lang="en" style="border-width: initial; border-style: none; background-color: rgb(243, 245, 247); padding: 10pt; font-family: courier, monospace; white-space: pre-wrap; overflow-wrap: break-word;"><span class="line"><span class="ResWord" style="color: rgb(160, 0, 0);">from</span> <span class="ID">pytwist.com.opsware.swmgmt</span> <span class="ResWord" style="color: rgb(160, 0, 0);">import</span> <span class="ID">SoftwarePolicyRef</span>, <span class="ID">SoftwarePolicyItemData</span></span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_2"></span><span class="anchor" id="line-2-97"></span><span class="ResWord" style="color: rgb(160, 0, 0);">from</span> <span class="ID">pytwist.com.opsware.pkg</span> <span class="ResWord" style="color: rgb(160, 0, 0);">import</span> <span class="ID">ZIPRef</span></span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_3"></span><span class="anchor" id="line-3-81"></span></span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_4"></span><span class="anchor" id="line-4-67"></span><span class="ID">SoftwarePolicyService</span>= <span class="ID">ts</span>.<span class="ID">swmgmt</span>.<span class="ID">SoftwarePolicyService</span></span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_5"></span><span class="anchor" id="line-5-63"></span></span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_6"></span><span class="anchor" id="line-6-55"></span><span class="ID">missingUnit</span> = <span class="ID">ZIPRef</span>(<span class="Number" style="color: rgb(0, 128, 192);">2710001</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_7"></span><span class="anchor" id="line-7-45"></span><span class="ID">pRef</span> = <span class="ID">SoftwarePolicyRef</span>(<span class="Number" style="color: rgb(0, 128, 192);">2160001</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_8"></span><span class="anchor" id="line-8-42"></span></span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_9"></span><span class="anchor" id="line-9-37"></span><span class="ID">pVO</span> = <span class="ID">SoftwarePolicyService</span>.<span class="ID">getSoftwarePolicyVO</span>(<span class="ID">pRef</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_10"></span><span class="anchor" id="line-10-32"></span><span class="ID">itemList</span> = <span class="ResWord" style="color: rgb(160, 0, 0);">list</span>(<span class="ID">pVO</span>.<span class="ID">getInstallableItemData</span>())</span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_11"></span><span class="anchor" id="line-11-29"></span><span class="ID">item</span> = <span class="ID">SoftwarePolicyItemData</span>()</span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_12"></span><span class="anchor" id="line-12-28"></span><span class="ID">item</span>.<span class="ID">setPolicyItem</span>(<span class="ID">missingUnit</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_13"></span><span class="anchor" id="line-13-24"></span><span class="ID">itemList</span>.<span class="ID">append</span>(<span class="ID">item</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_14"></span><span class="anchor" id="line-14-23"></span><span class="ID">pVO</span>.<span class="ID">setInstallableItemData</span>(<span class="ID">itemList</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-cabf193803fedbcc084a7d3b4c4d321099a623dc_15"></span><span class="anchor" id="line-15-21"></span><span class="ID">SoftwarePolicyService</span>.<span class="ID">update</span>(<span class="ID">pRef</span>, <span class="ID">pVO</span>, <span class="ResWord" style="color: rgb(160, 0, 0);">False</span>, <span class="ResWord" style="color: rgb(160, 0, 0);">False</span>)</span>
</pre></div></div><span class="anchor" id="line-1618" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><span class="anchor" id="line-1619" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><p class="line867" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;"></p><h2 id="Ad_hoc_Software_Installation" style="color: rgb(0, 0, 0); letter-spacing: normal; text-transform: none; font-family: sans-serif;">Ad hoc Software Installation</h2><span class="anchor" id="line-1620" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><span class="anchor" id="line-1621" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><p class="line874" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;">This script will install software against a server in an ad hoc manner. Ad hoc means we don't need to create a software policy and attach it to the server and then remediate. Supplying the server and software to install is sufficient. It's what happens when you right click on a server in the UI and select "Install Software"<span class="anchor" id="line-1622"></span><span class="anchor" id="line-1623"></span></p><p class="line874" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;"><br></p><img src="./mediawiki/images/PN/adhoc-install-software.png"><br><p class="line867" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;"><span class="anchor" id="line-1626"></span><span class="anchor" id="line-1627"></span><span class="anchor" id="line-1628"></span><span class="anchor" id="line-1629"></span><span class="anchor" id="line-1630"></span><span class="anchor" id="line-1631"></span><span class="anchor" id="line-1632"></span><span class="anchor" id="line-1633"></span><span class="anchor" id="line-1634"></span><span class="anchor" id="line-1635"></span><span class="anchor" id="line-1636"></span><span class="anchor" id="line-1637"></span><span class="anchor" id="line-1638"></span><span class="anchor" id="line-1639"></span><span class="anchor" id="line-1-190"></span></p><div class="highlight python" style="color: rgb(0, 0, 0); font-family: sans-serif;"><div class="codearea" dir="ltr" lang="en" style="margin: 0.5em 0px; padding: 0px; border: 1pt solid rgb(174, 189, 204); background-color: rgb(243, 245, 247);"><pre dir="ltr" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f" lang="en" style="border-width: initial; border-style: none; background-color: rgb(243, 245, 247); padding: 10pt; font-family: courier, monospace; white-space: pre-wrap; overflow-wrap: break-word;"><span class="line"><span class="ResWord" style="color: rgb(160, 0, 0);">from</span> <span class="ID">pytwist.com.opsware.swmgmt</span> <span class="ResWord" style="color: rgb(160, 0, 0);">import</span> <span class="ID">SoftwareInstallJobArgument</span>, <span class="ID">InstallableAttachableEntry</span></span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_2"></span><span class="anchor" id="line-2-98"></span><span class="ResWord" style="color: rgb(160, 0, 0);">from</span> <span class="ID">pytwist.com.opsware.pkg</span> <span class="ResWord" style="color: rgb(160, 0, 0);">import</span> <span class="ID">ZIPRef</span></span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_3"></span><span class="anchor" id="line-3-82"></span><span class="ResWord" style="color: rgb(160, 0, 0);">from</span> <span class="ID">pytwist.com.opsware.server</span> <span class="ResWord" style="color: rgb(160, 0, 0);">import</span> <span class="ID">ServerRef</span></span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_4"></span><span class="anchor" id="line-4-68"></span></span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_5"></span><span class="anchor" id="line-5-64"></span><span class="ID">e</span> = <span class="ID">InstallableAttachableEntry</span>()</span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_6"></span><span class="anchor" id="line-6-56"></span><span class="ID">e</span>.<span class="ID">setInstallables</span>([<span class="ID">ZIPRef</span>(<span class="Number" style="color: rgb(0, 128, 192);">625260001</span>)])</span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_7"></span><span class="anchor" id="line-7-46"></span><span class="ID">e</span>.<span class="ID">setPolicyAttachables</span>([<span class="ID">ServerRef</span>(<span class="Number" style="color: rgb(0, 128, 192);">2280001</span>)])</span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_8"></span><span class="anchor" id="line-8-43"></span></span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_9"></span><span class="anchor" id="line-9-38"></span><span class="ID">s</span> = <span class="ID">SoftwareInstallJobArgument</span>()</span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_10"></span><span class="anchor" id="line-10-33"></span><span class="ID">s</span>.<span class="ID">setInstallableAttachableEntries</span>([<span class="ID">e</span>])</span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_11"></span><span class="anchor" id="line-11-30"></span></span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_12"></span><span class="anchor" id="line-12-29"></span><span class="ID">jobRef</span> = <span class="ID">ts</span>.<span class="ID">swmgmt</span>.<span class="ID">SoftwarePolicyService</span>.<span class="ID">startInstallSoftware</span>(<span class="ID">s</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-4de2003d499118ff4ef68b846dd9dc976c97ef7f_13"></span><span class="anchor" id="line-13-25"></span><span class="ResWord" style="color: rgb(160, 0, 0);">print</span> <span class="String" style="color: rgb(0, 64, 128);">"</span><span class="String" style="color: rgb(0, 64, 128);">Submitted job: </span><span class="String" style="color: rgb(0, 64, 128);">%s</span><span class="String" style="color: rgb(0, 64, 128);">"</span> % <span class="ID">jobRef</span></span>
</pre></div></div><span class="anchor" id="line-1640" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><span class="anchor" id="line-1641" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><p class="line867" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;"></p><h2 id="Server_to_Software_policy_attachment_report" style="color: rgb(0, 0, 0); letter-spacing: normal; text-transform: none; font-family: sans-serif;">Server to Software policy attachment report</h2><span class="anchor" id="line-1642" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><span class="anchor" id="line-1643" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><p class="line862" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;">Building upon the services already explored;&nbsp;<tt class="backtick"></tt><tt class="backtick">SearchService</tt><tt class="backtick"></tt>,&nbsp;<tt class="backtick"></tt><tt class="backtick">FolderService</tt><tt class="backtick"></tt>&nbsp;and&nbsp;<tt class="backtick"></tt><tt class="backtick">ServerService</tt><tt class="backtick"></tt>.<span class="anchor" id="line-1644"></span><span class="anchor" id="line-1645"></span></p><p class="line874" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;">Create a report of all the software policies attached to every server with the full location of where this software policy is located in the library folder structure.<span class="anchor" id="line-1646"></span><span class="anchor" id="line-1647"></span><span class="anchor" id="line-1648"></span><span class="anchor" id="line-1649"></span><span class="anchor" id="line-1650"></span><span class="anchor" id="line-1651"></span><span class="anchor" id="line-1652"></span><span class="anchor" id="line-1653"></span><span class="anchor" id="line-1654"></span><span class="anchor" id="line-1655"></span><span class="anchor" id="line-1656"></span><span class="anchor" id="line-1657"></span><span class="anchor" id="line-1658"></span><span class="anchor" id="line-1659"></span><span class="anchor" id="line-1660"></span><span class="anchor" id="line-1661"></span><span class="anchor" id="line-1662"></span><span class="anchor" id="line-1663"></span><span class="anchor" id="line-1664"></span><span class="anchor" id="line-1665"></span><span class="anchor" id="line-1666"></span><span class="anchor" id="line-1667"></span><span class="anchor" id="line-1668"></span><span class="anchor" id="line-1669"></span><span class="anchor" id="line-1-192"></span></p><div class="highlight python" style="color: rgb(0, 0, 0); font-family: sans-serif;"><div class="codearea" dir="ltr" lang="en" style="margin: 0.5em 0px; padding: 0px; border: 1pt solid rgb(174, 189, 204); background-color: rgb(243, 245, 247);"><pre dir="ltr" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49" lang="en" style="border-width: initial; border-style: none; background-color: rgb(243, 245, 247); padding: 10pt; font-family: courier, monospace; white-space: pre-wrap; overflow-wrap: break-word;"><span class="line"><span class="Comment" style="color: rgb(0, 128, 0);">#!/opt/opsware/bin/python</span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_2"></span><span class="anchor" id="line-2-99"></span><span class="ResWord" style="color: rgb(160, 0, 0);">from</span> <span class="ID">pytwist</span> <span class="ResWord" style="color: rgb(160, 0, 0);">import</span> <span class="ID">twistserver</span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_3"></span><span class="anchor" id="line-3-83"></span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_4"></span><span class="anchor" id="line-4-69"></span><span class="ID">ts</span> = <span class="ID">twistserver</span>.<span class="ID">TwistServer</span>()</span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_5"></span><span class="anchor" id="line-5-65"></span><span class="ID">ServerService</span>= <span class="ID">ts</span>.<span class="ID">server</span>.<span class="ID">ServerService</span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_6"></span><span class="anchor" id="line-6-57"></span><span class="ID">SoftwarePolicyService</span>= <span class="ID">ts</span>.<span class="ID">swmgmt</span>.<span class="ID">SoftwarePolicyService</span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_7"></span><span class="anchor" id="line-7-47"></span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_8"></span><span class="anchor" id="line-8-44"></span><span class="ID">folderPath</span> = <span class="ResWord" style="color: rgb(160, 0, 0);">lambda</span> <span class="ID">folderRefs</span>: <span class="String" style="color: rgb(0, 64, 128);">'</span><span class="String" style="color: rgb(0, 64, 128);">/</span><span class="String" style="color: rgb(0, 64, 128);">'</span>.<span class="ID">join</span>(<span class="ID">c</span>.<span class="ID">name</span> <span class="ResWord" style="color: rgb(160, 0, 0);">for</span> <span class="ID">c</span> <span class="ResWord" style="color: rgb(160, 0, 0);">in</span> <span class="ID">folderRefs</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_9"></span><span class="anchor" id="line-9-39"></span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_10"></span><span class="anchor" id="line-10-34"></span><span class="Comment" style="color: rgb(0, 128, 0);"># For each server in the core.</span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_11"></span><span class="anchor" id="line-11-31"></span><span class="ResWord" style="color: rgb(160, 0, 0);">for</span> <span class="ID">ref</span> <span class="ResWord" style="color: rgb(160, 0, 0);">in</span> <span class="ID">ts</span>.<span class="ID">search</span>.<span class="ID">SearchService</span>.<span class="ID">findObjRefs</span>(<span class="ResWord" style="color: rgb(160, 0, 0);">None</span>,<span class="String" style="color: rgb(0, 64, 128);">'</span><span class="String" style="color: rgb(0, 64, 128);">device</span><span class="String" style="color: rgb(0, 64, 128);">'</span>):</span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_12"></span><span class="anchor" id="line-12-30"></span>    <span class="ID">vo</span> = <span class="ID">ServerService</span>.<span class="ID">getServerVO</span>(<span class="ID">ref</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_13"></span><span class="anchor" id="line-13-26"></span>    <span class="Comment" style="color: rgb(0, 128, 0);"># Look up the servers software policies.</span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_14"></span><span class="anchor" id="line-14-24"></span>    <span class="ID">swrefs</span> = <span class="ID">ServerService</span>.<span class="ID">getSoftwarePolicies</span>([<span class="ID">ref</span>])</span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_15"></span><span class="anchor" id="line-15-22"></span>    <span class="Comment" style="color: rgb(0, 128, 0);"># For each policy</span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_16"></span><span class="anchor" id="line-16-20"></span>    <span class="ID">sw</span> = <span class="ResWord" style="color: rgb(160, 0, 0);">None</span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_17"></span><span class="anchor" id="line-17-19"></span>    <span class="ResWord" style="color: rgb(160, 0, 0);">for</span> <span class="ID">sw</span> <span class="ResWord" style="color: rgb(160, 0, 0);">in</span> <span class="ID">SoftwarePolicyService</span>.<span class="ID">getSoftwarePolicyVOs</span>(<span class="ID">swrefs</span>):</span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_18"></span><span class="anchor" id="line-18-19"></span>        <span class="Comment" style="color: rgb(0, 128, 0);"># compute software repository path.</span></span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_19"></span><span class="anchor" id="line-19-17"></span>        <span class="ID">path</span> = <span class="ID">folderPath</span>(<span class="ID">ts</span>.<span class="ID">folder</span>.<span class="ID">FolderService</span>.<span class="ID">getPath</span>(<span class="ID">sw</span>.<span class="ID">folder</span>)[<span class="Number" style="color: rgb(0, 128, 192);">1</span>:])</span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_20"></span><span class="anchor" id="line-20-16"></span>        <span class="ResWord" style="color: rgb(160, 0, 0);">print</span> <span class="String" style="color: rgb(0, 64, 128);">"</span><span class="String" style="color: rgb(0, 64, 128);">%s</span><span class="String" style="color: rgb(0, 64, 128);">: </span><span class="String" style="color: rgb(0, 64, 128);">%s</span><span class="String" style="color: rgb(0, 64, 128);">/</span><span class="String" style="color: rgb(0, 64, 128);">%s</span><span class="String" style="color: rgb(0, 64, 128);">"</span>  %( <span class="ID">vo</span>.<span class="ID">name</span>, <span class="ID">path</span>, <span class="ID">sw</span>.<span class="ID">name</span>)</span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_21"></span><span class="anchor" id="line-21-14"></span>    <span class="ResWord" style="color: rgb(160, 0, 0);">if</span> <span class="ID">sw</span> <span class="ResWord" style="color: rgb(160, 0, 0);">is</span> <span class="ResWord" style="color: rgb(160, 0, 0);">None</span>:</span>
<span class="line"><span class="LineAnchor" id="CA-90cc519887ec741f66d81243dfce747a7fd6ff49_22"></span><span class="anchor" id="line-22-12"></span>        <span class="ResWord" style="color: rgb(160, 0, 0);">print</span> <span class="String" style="color: rgb(0, 64, 128);">"</span><span class="String" style="color: rgb(0, 64, 128);">%s</span><span class="String" style="color: rgb(0, 64, 128);">: No software polices attached</span><span class="String" style="color: rgb(0, 64, 128);">"</span> % <span class="ID">vo</span>.<span class="ID">name</span></span>
</pre></div></div><span class="anchor" id="line-1670" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><p class="line862" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;">Execution.&nbsp;<em>It will take a while on a system with many servers.</em><span class="anchor" id="line-1671"></span><span class="anchor" id="line-1672"></span><span class="anchor" id="line-1673"></span><span class="anchor" id="line-1674"></span><span class="anchor" id="line-1675"></span><span class="anchor" id="line-1676"></span><span class="anchor" id="line-1677"></span></p><pre style="color: rgb(0, 0, 0); border-width: 1pt; border-style: solid; border-color: rgb(174, 189, 204); background-color: rgb(243, 245, 247); padding: 5pt; font-family: courier, monospace; white-space: pre-wrap; overflow-wrap: break-word;"><span class="anchor" id="line-1-31"></span>[root@dc1 SoftwarePolicyService]# ./serverSWPolicies.py
<span class="anchor" id="line-2-27"></span>32540685155e: Opsware/Tools/Python Opsware API Access/Python Opsware API Access
<span class="anchor" id="line-3-18"></span>dc1.blue.local: Opsware/Tools/ISMtool/ISMtool
<span class="anchor" id="line-4-13"></span>sat1.blue.local: No software polices attached
<span class="anchor" id="line-5-11"></span>win2003-bt7xcc6: No software polices attached</pre><span class="anchor" id="line-1678" style="color: rgb(0, 0, 0); font-family: sans-serif;"></span><p class="line874" style="color: rgb(0, 0, 0); letter-spacing: normal; font-family: sans-serif; font-size: 16px;">Improvements to the code to improve performance could involve creating a cache for the software policy folder path to avoid recomputation.</p>