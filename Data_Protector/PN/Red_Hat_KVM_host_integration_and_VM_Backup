&lt;h3&gt;This topic provides information on Red Hat KVM host integration with Data Protector and&amp;nbsp;&lt;span style="background-color: transparent;"&gt;backup/restore on online virtual machines (VMs) in Red Hat KVM host.&lt;/span&gt;&lt;/h3&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;h2&gt;Red Hat Kernel-based Virtual Machine&lt;/h2&gt;&lt;div&gt;&lt;div&gt;Red Hat Kernel-based Virtual Machine (KVM) is an open source virtualization technology built&amp;nbsp;&lt;span style="background-color: transparent;"&gt;into Linux. Specifically, KVM lets you turn Linux into a hypervisor that allows a host machine&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;to run multiple, isolated virtual environments called guests or virtual machines (VMs).&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;KVM converts Linux into a type-1 (bare-metal) hypervisor. All hypervisors need some&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;operating system-level components such as a memory manager, process scheduler,&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;input/output (I/O) stack, device drivers, security manager, a network stack, and more - to run&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;VMs. KVM has all these components because itâ€™s part of the Linux kernel. Every VM is&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;implemented as a regular Linux process, scheduled by the standard Linux scheduler, with&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;dedicated virtual hardware like a network card, graphics adapter, CPU(s), memory, and disks.&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;h2&gt;&lt;span style="background-color: transparent;"&gt;Data Protector and Red Hat KVM integration&lt;br&gt;&lt;/span&gt;&lt;/h2&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Data Protector uses scripts to backup the live, running, or online VMs in a Red Hat KVM host.&amp;nbsp;&lt;span style="background-color: transparent;"&gt;The scripts are saved in the pre-exec and post-exec areas of the backup specification. The&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;pre-exec script creates a live external snapshot of the VM and saves it in the local/SAN&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;storage mount point configured for &lt;b&gt;$BACKUPDIR&lt;/b&gt; variable in the backup script. This script&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;uses all the Red Hat KVM features and functionality to carry out the operations.&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;The restoration of the VMs is based on the post-exec scripts for restore. In Data Protector,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;select the backed up directory (as specified in the &lt;b&gt;$BACKUPDIR &lt;/b&gt;variable) for choosing the&amp;nbsp;&lt;span style="background-color: transparent;"&gt;VMs for restore. These selected VMs are copied to restored path &lt;b&gt;$RESTORED_PATH &lt;/b&gt;variable&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;as defined in the restore script &lt;b&gt;KVM_snap_Restore.sh&lt;/b&gt;. Select the VM directory from the&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;$BACKUPDIR &lt;/b&gt;variable in the backup script and choose a restore path &lt;b&gt;$RESTORED_PATH&lt;/b&gt;&amp;nbsp;&lt;span style="background-color: transparent;"&gt;variable defined in the restore script.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;h3&gt;&lt;span style="background-color: transparent;"&gt;Use cases&lt;br&gt;&lt;/span&gt;&lt;/h3&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;The Data Protector and Red Hat KVM integration support the following use cases:&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Single VM backup and restore&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Multi VM backup and single VM restore&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Multi VM backup and multi VM restore&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;Supported disk types&lt;/h3&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;There is no limit to disk types supported. Red Hat KVM scripts uses the &lt;b&gt;virsh &lt;/b&gt;utility to create&amp;nbsp;&lt;span style="background-color: transparent;"&gt;a snapshot.&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;h2&gt;&lt;span style="background-color: transparent;"&gt;Prerequisites&lt;/span&gt;&lt;/h2&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Ensure the KVM host is imported on the Cell Manager.&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Ensure that the utility packages &lt;b&gt;virt-manager 1.4.3&lt;/b&gt; or later versions and&lt;b&gt; virsh 3.9.0 &lt;/b&gt;or&amp;nbsp;&lt;span style="background-color: transparent;"&gt;later versions are installed.&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Ensure there is enough free storage (SAN or local filesystem) for backing up all the online&amp;nbsp;&lt;span style="background-color: transparent;"&gt;VMs in Red Hat KVM host.&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;Storage requirements&lt;/h3&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Mount your backup filesystem as &lt;b&gt;/kvmbackup&lt;/b&gt;.&lt;br&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;div&gt;Create a SAN or local filesystem with a storage that can backup all the online VMs in Red&amp;nbsp;&lt;span style="background-color: transparent;"&gt;Hat KVM host for any given backup session. For example, consider three online VMs in a&amp;nbsp;&lt;/span&gt;&lt;span style="background-color: transparent;"&gt;Red Hat KVM host with sizes 10 GB, 20 GB, and 30 GB.&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ol&gt;&lt;ul&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;span style="background-color: transparent;"&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;If you are backing up all three VMs, ensure that the /kvmbackup directory has a free&amp;nbsp;&lt;span style="background-color: transparent;"&gt;storage of minimum 75-80 GB.&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;div&gt;If you are backing up VMs individually, ensure that the /kvmbackup directory has a&amp;nbsp;&lt;span style="background-color: transparent;"&gt;free storage more than the VM with the largest size.&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&gt;&lt;div&gt;The storage mentioned is only an indicated storage space. Actual storage space may&amp;nbsp;&lt;span style="background-color: transparent;"&gt;vary depending on your environment.&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;3.&amp;nbsp;&amp;nbsp;Consider also the growth in your Red Hat KVM environment while planning your storage.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;h2&gt;Install Red Hat KVM&lt;br&gt;&lt;/h2&gt;&lt;div&gt;Install KVM using the &lt;b&gt;qemu-kvm-rhev&lt;/b&gt; package to avail the online VM snapshot capability.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;h2&gt;Backup online VMs in Red Hat KVM host&lt;br&gt;&lt;/h2&gt;&lt;div&gt;&lt;div&gt;To integrate Red Hat KVM host with Data Protector and then to backup online VMs in it,&amp;nbsp;&lt;span style="background-color: transparent;"&gt;complete the following steps:&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;ol&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Download the KVM scripts zip package from ITOM Marketplace. Contact Customer Support if&amp;nbsp;&lt;span style="background-color: transparent;"&gt;you have any issues.&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;Log into Red Hat KVM host and extract the downloaded scripts in the &lt;b&gt;/opt/omni/lbin&lt;/b&gt;&amp;nbsp;&lt;span style="background-color: transparent;"&gt;path. The following scripts are extracted:&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;ul&gt;&lt;li&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;KVM_snap_backup.sh&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;KVM_cleanup_post_backup.sh&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&gt;&lt;div&gt;&lt;span style="background-color: transparent;"&gt;KVM_snap_Restore.sh&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;