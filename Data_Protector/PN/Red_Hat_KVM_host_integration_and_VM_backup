<h3>This topic provides information on Red Hat KVM host integration with Data Protector and&nbsp;<span style="background-color: transparent;">backup/restore on online virtual machines (VMs) in Red Hat KVM host.</span></h3><div><br></div><h2>Red Hat Kernel-based Virtual Machine</h2><div><div>Red Hat Kernel-based Virtual Machine (KVM) is an open source virtualization technology built&nbsp;<span style="background-color: transparent;">into Linux. Specifically, KVM lets you turn Linux into a hypervisor that allows a host machine&nbsp;</span><span style="background-color: transparent;">to run multiple, isolated virtual environments called guests or virtual machines (VMs).&nbsp;</span><span style="background-color: transparent;">KVM converts Linux into a type-1 (bare-metal) hypervisor. All hypervisors need some&nbsp;</span><span style="background-color: transparent;">operating system-level components such as a memory manager, process scheduler,&nbsp;</span><span style="background-color: transparent;">input/output (I/O) stack, device drivers, security manager, a network stack, and more - to run&nbsp;</span><span style="background-color: transparent;">VMs. KVM has all these components because itâ€™s part of the Linux kernel. Every VM is&nbsp;</span><span style="background-color: transparent;">implemented as a regular Linux process, scheduled by the standard Linux scheduler, with&nbsp;</span><span style="background-color: transparent;">dedicated virtual hardware like a network card, graphics adapter, CPU(s), memory, and disks.</span></div></div><div><span style="background-color: transparent;"><br></span></div><h2><span style="background-color: transparent;">Data Protector and Red Hat KVM integration<br></span></h2><div><span style="background-color: transparent;"><div>Data Protector uses scripts to backup the live, running, or online VMs in a Red Hat KVM host.&nbsp;<span style="background-color: transparent;">The scripts are saved in the pre-exec and post-exec areas of the backup specification. The&nbsp;</span><span style="background-color: transparent;">pre-exec script creates a live external snapshot of the VM and saves it in the local/SAN&nbsp;</span><span style="background-color: transparent;">storage mount point configured for <b>$BACKUPDIR</b> variable in the backup script. This script&nbsp;</span><span style="background-color: transparent;">uses all the Red Hat KVM features and functionality to carry out the operations.&nbsp;</span><span style="background-color: transparent;">The restoration of the VMs is based on the post-exec scripts for restore. In Data Protector,</span></div><div>select the backed up directory (as specified in the <b>$BACKUPDIR </b>variable) for choosing the&nbsp;<span style="background-color: transparent;">VMs for restore. These selected VMs are copied to restored path <b>$RESTORED_PATH </b>variable&nbsp;</span><span style="background-color: transparent;">as defined in the restore script <b>KVM_snap_Restore.sh</b>. Select the VM directory from the</span></div><div><b>$BACKUPDIR </b>variable in the backup script and choose a restore path <b>$RESTORED_PATH</b>&nbsp;<span style="background-color: transparent;">variable defined in the restore script.</span></div><div><span style="background-color: transparent;"><br></span></div><h3><span style="background-color: transparent;">Use cases<br></span></h3><div><span style="background-color: transparent;"><div>The Data Protector and Red Hat KVM integration support the following use cases:</div><div><ul><li><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div>Single VM backup and restore</div></span></div></span></li><li><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div>Multi VM backup and single VM restore</div></span></div></span></li><li><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div>Multi VM backup and multi VM restore</div></span></div></span></li></ul><h3>Supported disk types</h3></div><div><div>There is no limit to disk types supported. Red Hat KVM scripts uses the <b>virsh </b>utility to create&nbsp;<span style="background-color: transparent;">a snapshot.</span></div></div><div><span style="background-color: transparent;"><br></span></div><h2><span style="background-color: transparent;">Prerequisites</span></h2><div><span style="background-color: transparent;"><div><ul><li><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div>Ensure the KVM host is imported on the Cell Manager.</div></span></div></span></div></span></li><li><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div>Ensure that the utility packages <b>virt-manager 1.4.3</b> or later versions and<b> virsh 3.9.0 </b>or&nbsp;<span style="background-color: transparent;">later versions are installed.</span></div></span></div></span></div></span></li><li><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div>Ensure there is enough free storage (SAN or local filesystem) for backing up all the online&nbsp;<span style="background-color: transparent;">VMs in Red Hat KVM host.</span></div></span></div></span></div></span></li></ul><h3>Storage requirements</h3></div><div><ol><li><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div>Mount your backup filesystem as <b>/kvmbackup</b>.<br></div></span></div></span></div></span></li><li><div>Create a SAN or local filesystem with a storage that can backup all the online VMs in Red&nbsp;<span style="background-color: transparent;">Hat KVM host for any given backup session. For example, consider three online VMs in a&nbsp;</span><span style="background-color: transparent;">Red Hat KVM host with sizes 10 GB, 20 GB, and 30 GB.</span></div></li></ol><ul><li><span style="background-color: transparent;"><span style="background-color: transparent;"><span style="background-color: transparent;"><div>If you are backing up all three VMs, ensure that the /kvmbackup directory has a free&nbsp;<span style="background-color: transparent;">storage of minimum 75-80 GB.</span></div></span></span></span></li><li><div>If you are backing up VMs individually, ensure that the /kvmbackup directory has a&nbsp;<span style="background-color: transparent;">free storage more than the VM with the largest size.</span></div></li><li><div>The storage mentioned is only an indicated storage space. Actual storage space may&nbsp;<span style="background-color: transparent;">vary depending on your environment.</span></div></li></ul><div>&nbsp; &nbsp; &nbsp; &nbsp;3.&nbsp;&nbsp;Consider also the growth in your Red Hat KVM environment while planning your storage.</div></div><div><br></div><h2>Install Red Hat KVM<br></h2><div>Install KVM using the <b>qemu-kvm-rhev</b> package to avail the online VM snapshot capability.<br></div><div><br></div><h2>Backup online VMs in Red Hat KVM host<br></h2><div><div>To integrate Red Hat KVM host with Data Protector and then to backup online VMs in it,&nbsp;<span style="background-color: transparent;">complete the following steps:</span></div></div><div><span style="background-color: transparent;"><div><ol><li><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div><span style="background-color: transparent;"><div>Download the KVM scripts zip package from ITOM Marketplace. Contact Customer Support if&nbsp;<span style="background-color: transparent;">you have any issues.</span></div></span></div></span></div></span></div></span></li></ol></div></span></div></span></div></span></div></span></div>