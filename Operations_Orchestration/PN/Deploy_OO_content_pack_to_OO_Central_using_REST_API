<p class="MsoNormal">Organizations are embracing DevOps practices that combine
software development and information technology operations. DevOps practices
shorten the systems development life cycle while delivering features, fixes and
updates frequently in close alignment with business objectives. &nbsp;Continuous integration and continuous
deployment processes of DevOps includes the following activities:<o:p></o:p></p>

<p class="MsoListParagraphCxSpFirst">Development<o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle">Build<o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle">Deployment<o:p></o:p></p>

<p class="MsoListParagraphCxSpLast">Test<o:p></o:p></p>

<p class="MsoNormal"><b>Development<o:p></o:p></b></p>

<p class="MsoNormal">Large enterprises running Micro Focus Operations Orchestration
(OO) often have several OO developers and separate environments for
development, test and production. OO developers develop OO content packs and
commit their code changes to version control system. An OO content pack
contains business intelligence to automate certain IT processes. OO content
packs are developed using the OO studio application or the OO web designer
application.<o:p></o:p></p>

<p class="MsoNormal"><b>Build<o:p></o:p></b></p>

<p class="MsoNormal">After content pack code changes are committed to version
control system, a new version of content pack is built using the OO Shell
Authoring (OOSHA) utility. The OOSHA utility builds OO content pack using
contents of a project folder downloaded from version control repository.<o:p></o:p></p>

<p class="MsoNormal"><b>Deployment<o:p></o:p></b></p>

<p class="MsoNormal">After OO content pack is built, it needs to be deployed onto
OO Central Application for testing and use in production environment. OO
content pack is deployed onto OO Central Application in one of the following
ways:<o:p></o:p></p>

<p class="MsoListParagraphCxSpFirst">Using OO Central UIâ€™s deploy content pack
feature. This method requires manual login to the OO Central server and cannot
be used to deploy content packs in an automated fashion.<o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle">Using Operations Orchestration Shell (OOSH)
utility. This method requires installation of additional piece of software.<o:p></o:p></p>

<p class="MsoListParagraphCxSpLast">Using OO REST API. A REST API is an
application program interface (API) that uses HTTP requests to GET, PUT, POST
and DELETE data in an application.<o:p></o:p></p>

<p class="MsoNormal">Either the OOSH utility or OO REST API can be used to deploy
content packs in an automated fashion. Certain enterprises may prefer to use OO
REST APIs to deploy content packs for the following reasons:<o:p></o:p></p>

<p class="MsoListParagraphCxSpFirst">Eliminate need to install an additional
piece of software on their content build and deploy systems.<o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle">Integrate into existing deployment
automation mechanisms. <o:p></o:p></p>

<p class="MsoListParagraphCxSpLast">Gain more control around automation of
deployment of content packs to OO Central.<o:p></o:p></p>

<p class="MsoNormal" style="margin-left:.25in"><o:p>&nbsp;</o:p></p>

<p class="MsoNormal" style="margin-left:.25in"><o:p>&nbsp;</o:p></p>

<p class="MsoNormal"><b>Test<o:p></o:p></b></p>

<p class="MsoNormal">After content pack has been deployed, testing of newly
deployed content pack can be automated or done manually.<o:p></o:p></p>

<p class="MsoNormal">This article shows a sample power shell script that can be
used to automate deployment of OO content pack to OO Central Application.
Intent of this script is to show how to invoke OO REST APIs to automate deployment
of OO content packs to OO Central Application. This script can be further
enhanced to perform additional checks required for your environment, to improve
performance, to use as a reference to develop it in your preferred programming language,
to use as a reference to make other OO REST API calls, etc. At a high level,
this script performs the following:<o:p></o:p></p>

<p class="MsoListParagraphCxSpFirst">Validates the following input values: OO
Central Application URL, OO Central username, OO Central user password, OO content
pack name and OO content pack file<o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle">Retrieves cross reference token from OO
Central Application URL<o:p></o:p></p>

<p class="MsoListParagraphCxSpLast">Uses cross reference token to deploy content
pack to OO Central Application.<o:p></o:p></p>

<p class="MsoNormal">Usage of the script is described at the beginning of this
script and functioning of this script is explained in comments throughout the
script.<o:p></o:p></p>

<p class="MsoNormal"><o:p>&nbsp;</o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
File name: OODeployCP.ps1<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Purpose: 1. Deploys a content pack to OO Central application using OO <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Central REST APIs.&nbsp; <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. This script is meant to be taken
as an example. Enhance this<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;script to meet your organization's coding
standards.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;3. Even though script is in powershell, you
can use similar <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; concepts to write this program in
other languages.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4. Use as-is. Not officially
supported through Micro Focus.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Limitations: 1. Does not use proxy. If your environment requires proxy to <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connect to the OO Central
Application, enhance this script<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;to accomodate web requests through proxy. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Usage: 1. Runs on Windows OS and it requires Windows Powershell on the<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;operating system. Copy this script to a
directory on the windows<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;server/workstation/laptop.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. Open powershell window <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. Run Get-Help .\OODeployCP.ps1 to get
a list of parameters that<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;needs to be passed.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;4. Sample usage: .\OODeployCP.ps1
-OOCentralURL <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://&lt;OOCentralHostName&gt;:&lt;Port&gt;/oo
-UserName <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; admin -Passwd 123
-ContentPackName NAS â€“<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PathToContentPackJarFile
C:\temp\NAS-1.0.0.jar<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5. Parameter explanation:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OOCentralURL: URL to access OO
Central UI. This URL can be either<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;http or https depending on how OO is setup in
your <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; environment.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserName: OO central username that has
privileges to deploy OO<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;content pack.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Password: Password for the user to
login to OO Central <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ContentPackName: Any meaningful name
for the content that you <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; are deploying to OO<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PathToContentPackJarFile: Full path
to the OO content pack jar<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;file. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Validate input parameters for NULL, empty and mandatory conditions.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">param
(<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$OOCentralURL,<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$UserName,<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$Passwd,<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$ContentPackName,<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$PathToContentPackJarFile&nbsp;&nbsp;&nbsp; <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Returns true if supplied object and/or string is NULL or empty<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">function
IsNull($object) {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; if ($object -eq $null) {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $true<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; if ($object -is [String] -and $object -eq
[String]::Empty) {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $true<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; return $false<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Validate format of supplied OO Central URL<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$uri
= $OOCentralURL -as [System.URI]<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">if
(-Not (($uri.AbsoluteURI -ne $null) -and ($uri.Scheme -eq 'http' -or
$uri.Scheme -eq 'https') -and
($uri.AbsoluteURI.Substring($uri.AbsoluteURI.Length - 3) -eq '/oo') ) ){<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; throw 'The supplied OO central URL: ' +
'"' + $OOCentralURL + '"' + ' is invalid. Format of OO Central URLs
are https://&lt;OOCentralFQDNorIP&gt;:&lt;Port&gt;/oo or
http://&lt;OOCentralFQDNorIP&gt;:&lt;Port&gt;/oo'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Trusts all certificates including self-signed root certificates<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
generated by OO<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">add-type
@"<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; using System.Net;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; using
System.Security.Cryptography.X509Certificates;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; public class TrustAllCertsPolicy :
ICertificatePolicy {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public bool CheckValidationResult(<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ServicePoint srvPoint,
X509Certificate certificate,<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WebRequest request, int certificateProblem)
{<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">"@<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">[System.Net.ServicePointManager]::CertificatePolicy
= New-Object TrustAllCertsPolicy<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">[Net.ServicePointManager]::SecurityProtocol
= [Net.SecurityProtocolType]::Ssl3, [Net.SecurityProtocolType]::Tls,
[Net.SecurityProtocolType]::Tls11, [Net.SecurityProtocolType]::Tls12<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Validates supplied OO content pack jar file <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">if
( -not (Test-Path "$PathToContentPackJarFile")) {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; throw 'File ' + $PathToContentPackJarFile +
' Does not exist'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}&nbsp; <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">elseif
(-not (Test-Path "$PathToContentPackJarFile" -PathType Leaf)){<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; throw $PathToContentPackJarFile + ' is not
a file'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">elseif
(($PathToContentPackJarFile.Substring($PathToContentPackJarFile.Length - 4))
-ne '.jar'){<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; throw $PathToContentPackJarFile + ' does
not have .jar extension'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}
<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Create authorization header value using supplied OO Central user name <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
and password. This authorization header value would be used in REST API <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
calls to OO Central Application.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$AuthPlainText
= $UserName + ':' + $Passwd<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$AuthPlainTextBytes
= [System.Text.Encoding]::UTF8.GetBytes($AuthPlainText)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$AuthEncodedText
=[System.Convert]::ToBase64String($AuthPlainTextBytes)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$AuthHeaderValue
= "Basic $AuthEncodedText"<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
OO requires cross reference token to be able to perform <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
create, delete or update operations.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Cross reference token from OO can be obtained by making a <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
GET REST API call to any one of the valid OO REST URIs.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Make a GET REST API call to OO and store session information.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$GetRequestURL
= $OOCentralURL + '/rest/v2/version'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">try{<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; $GetReqWebResponse = Invoke-WebRequest
-Method Get -Uri $GetRequestURL -Headers @{ 'Authorization' =
$AuthHeaderValue&nbsp; } -SessionVariable
'WebSession'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">catch{<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; If (IsNull($GetReqWebResponse)) {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw $($PSItem.ToString()) <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; else {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw 'Response code is ' +
$GetReqWebResponse.StatusCode + $($PSItem.ToString())<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">If
(IsNull($WebSession)) {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; throw 'Cannot open web session to the OO
Central Application'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Retrieve cross reference token cookie value from the web session<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
that was opened in GET call previously.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$Cookies
= $WebSession.Cookies.GetCookies($GetRequestURL) <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">If
(IsNull($Cookies)) {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; throw 'Unable to retrieve cookies from GET
request to OO Central Application'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">foreach
($cookie in $Cookies) { <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($($cookie.name) -eq
"X-CSRF-TOKEN-OO") {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $xcsrfToken = $($cookie.value)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;
<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">If
(IsNull($xcsrfToken)) {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; throw 'X-CSRF-TOKEN-OO cookie is null or
empty'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Construct OO deployment URI using the supplied content pack name<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$deployURL
= $OOCentralURL + '/rest/v2/content-packs/' + $ContentPackName<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Form request headers to be used in a PUT call to deploy <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
content pack to OO Central Application.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$headers
= @{<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; 'Content-Type' = 'application/octet-stream'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; 'accept' = 'application/json'<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; 'Authorization' = $AuthHeaderValue<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; 'X-CSRF-TOKEN' = $xcsrfToken<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
OO deploy content pack API requires that entire request body<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
consist of content of "OO content pack" jar file<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">$ooContentPackBytes
= [System.IO.File]::ReadAllBytes($PathToContentPackJarFile)<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Deploy OO Content Pack to OO Central Server by making a <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
PUT REST API call to OO<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">try{<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; $PutReqWebResponse = Invoke-WebRequest
-Method Put -Uri $deployURL -Headers $headers -Body $ooContentPackBytes
-WebSession $WebSession&nbsp; <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">catch{<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; # Something went wrong<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If (IsNull($PutReqWebResponse)) {<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw $($PSItem.ToString()) <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; else
{<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw 'Response code is ' +
$PutReqWebResponse.StatusCode + $($PSItem.ToString())<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">#
Display response message from deploy content pack request to OO<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">If
(-Not (IsNull($PutReqWebResponse))){<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; $JSONResponse = ConvertFrom-Json -InputObject
$PutReqWebResponse.Content<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; Write-Host 'Response code:
'$PutReqWebResponse.StatusCode
':'$JSONResponse.contentPackResponses."$ContentPackName.jar".responses.message<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><span style="font-family:Consolas;mso-bidi-font-family:&quot;Courier New&quot;">}</span><span style="font-family:&quot;Courier New&quot;"><o:p></o:p></span></p>