<h1>Deploy OO content pack to OO Central using REST APIs<o:p></o:p></h1><h1>

<p class="MsoNormal"><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">Organizations are embracing DevOps practices that combine
software development and information technology operations. DevOps practices
shorten the systems development life cycle while delivering features, fixes and
updates frequently in close alignment with business objectives. </span><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">&nbsp;</span><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">Continuous integration and continuous
deployment processes of DevOps includes the following activities:</span><br></p><p class="MsoNormal"><o:p></o:p></p>

<p class="MsoListParagraphCxSpFirst"><ol><li>Development</li><li>Build</li><li>Deployment</li><li>Test</li></ol><o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle"><o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle"><o:p></o:p></p>

<p class="MsoListParagraphCxSpLast"><o:p></o:p></p>

<p class="MsoNormal"><b>Development<o:p></o:p></b></p>

<p class="MsoNormal">Large enterprises running Micro Focus Operations Orchestration
(OO) often have several OO developers and separate environments for
development, test and production. OO developers develop OO content packs and
commit their code changes to version control system. An OO content pack
contains business intelligence to automate certain IT processes. OO content
packs are developed using the OO studio application or the OO web designer
application.<o:p></o:p></p>

<p class="MsoNormal"><b>Build<o:p></o:p></b></p>

<p class="MsoNormal">After content pack code changes are committed to version
control system, a new version of content pack is built using the OO Shell
Authoring (OOSHA) utility. The OOSHA utility builds OO content pack using
contents of a project folder downloaded from version control repository.<o:p></o:p></p>

<p class="MsoNormal"><b>Deployment<o:p></o:p></b></p>

<p class="MsoNormal">After OO content pack is built, it needs to be deployed onto
OO Central Application for testing and use in production environment. OO
content pack is deployed onto OO Central Application in one of the following
ways:<o:p></o:p></p>

<p class="MsoListParagraphCxSpFirst"><ol><li>Using OO Central UI’s deploy content pack
feature. This method requires manual login to the OO Central server and cannot
be used to deploy content packs in an automated fashion.</li><li>Using Operations Orchestration Shell (OOSH)
utility. This method requires installation of additional piece of software.</li><li>Using OO REST API. A REST API is an
application program interface (API) that uses HTTP requests to GET, PUT, POST
and DELETE data in an application.</li></ol><o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle"><o:p></o:p></p>

<p class="MsoListParagraphCxSpLast"><o:p></o:p></p>

<p class="MsoNormal">Either the OOSH utility or OO REST API can be used to deploy
content packs in an automated fashion. Certain enterprises may prefer to use OO
REST APIs to deploy content packs for the following reasons:<o:p></o:p></p>

<p class="MsoListParagraphCxSpFirst"><ol><li>Eliminate need to install an additional
piece of software on their content build and deploy systems.</li><li>Integrate into existing deployment
automation mechanisms. </li><li>Gain more control around automation of
deployment of content packs to OO Central.</li></ol><o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle"><o:p></o:p></p>

<p class="MsoListParagraphCxSpLast"><o:p></o:p></p>

<p class="MsoNormal" style="margin-left:.25in"><b style="font-size: inherit; letter-spacing: 0.2px; color: inherit; font-family: inherit; text-transform: initial; background-color: transparent;">Test</b><br></p>

<p class="MsoNormal">After content pack has been deployed, testing of newly
deployed content pack can be automated or done manually.<o:p></o:p></p>

<p class="MsoNormal">This article shows a sample power shell script that can be
used to automate deployment of OO content pack to OO Central Application.
Intent of this script is to show how to invoke OO REST APIs to automate deployment
of OO content packs to OO Central Application. This script can be further
enhanced to perform additional checks required for your environment, to improve
performance, to use as a reference to develop it in your preferred programming language,
to use as a reference to make other OO REST API calls, etc. At a high level,
this script performs the following:<o:p></o:p></p>

<p class="MsoListParagraphCxSpFirst"><ol><li>Validates the following input values: OO
Central Application URL, OO Central username, OO Central user password, OO content
pack name and OO content pack file</li><li>Retrieves cross reference token from OO
Central Application URL</li><li>Uses cross reference token to deploy content
pack to OO Central Application.</li></ol><o:p></o:p></p>

<p class="MsoListParagraphCxSpMiddle"><o:p></o:p></p>

<p class="MsoListParagraphCxSpLast"><o:p></o:p></p>

<p class="MsoNormal">Usage of the script is described at the beginning of this
script and functioning of this script is explained in comments throughout the
script.<o:p></o:p></p>

<p class="MsoNormal"><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; text-transform: initial; background-color: transparent;"><font face="Times New Roman">#
File name: OODeployCP.ps1</font></span></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Purpose: 1. Deploys a content pack to OO Central application using OO <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Central REST APIs.&nbsp; <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. This script is meant to be taken
as an example. Enhance this<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;script to meet your organization's coding
standards.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. Even though script is in
powershell, you can use similar <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; concepts to write this program in
other languages.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4. Use as-is. Not officially
supported through Micro Focus.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Limitations: 1. Does not use proxy. If your environment requires proxy to <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connect to the OO Central
Application, enhance this script<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;to accomodate web requests through proxy. <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Usage: 1. Runs on Windows OS and it requires Windows Powershell on the<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;operating system. Copy this script to a
directory on the windows<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;server/workstation/laptop.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. Open powershell window <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. Run Get-Help .\OODeployCP.ps1 to get
a list of parameters that<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;needs to be passed.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;4. Sample usage: .\OODeployCP.ps1
-OOCentralURL <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://&lt;OOCentralHostName&gt;:&lt;Port&gt;/oo
-UserName <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; admin -Passwd 123
-ContentPackName NAS –<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PathToContentPackJarFile
C:\temp\NAS-1.0.0.jar<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5. Parameter explanation:<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OOCentralURL: URL to access OO
Central UI. This URL can be either<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;http or https depending on how OO is setup in
your <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; environment.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserName: OO central username that has
privileges to deploy OO</font></p><p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman"><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; text-transform: initial; background-color: transparent;">#</span><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; text-transform: initial; background-color: transparent;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; text-transform: initial; background-color: transparent;">&nbsp;</span><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; text-transform: initial; background-color: transparent;">content pack.</span></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Password: Password for the user to
login to OO Central <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ContentPackName: Any meaningful name
for the content that you <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; are deploying to OO<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PathToContentPackJarFile: Full path
to the OO content pack jar<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;file. <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Validate input parameters for NULL, empty and mandatory conditions.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">param
(<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$OOCentralURL,<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$UserName,<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$Passwd,<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$ContentPackName,<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;
[Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$PathToContentPackJarFile&nbsp;&nbsp;&nbsp; <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">)<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Returns true if supplied object and/or string is NULL or empty<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">function
IsNull($object) {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; if ($object -eq $null) {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $true<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; }<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman"><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; text-transform: initial; background-color: transparent;">&nbsp; &nbsp;&nbsp;</span><span style="font-size: inherit; letter-spacing: 0.2px; color: inherit; text-transform: initial; background-color: transparent;">if ($object -is [String] -and $object -eq
[String]::Empty) {</span><br></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $true<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; }<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; return $false<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Validate format of supplied OO Central URL<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$uri
= $OOCentralURL -as [System.URI]<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">if
(-Not (($uri.AbsoluteURI -ne $null) -and ($uri.Scheme -eq 'http' -or
$uri.Scheme -eq 'https') -and
($uri.AbsoluteURI.Substring($uri.AbsoluteURI.Length - 3) -eq '/oo') ) ){<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; throw 'The supplied OO central URL: ' +
'"' + $OOCentralURL + '"' + ' is invalid. Format of OO Central URLs
are https://&lt;OOCentralFQDNorIP&gt;:&lt;Port&gt;/oo or
http://&lt;OOCentralFQDNorIP&gt;:&lt;Port&gt;/oo'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Trusts all certificates including self-signed root certificates<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
generated by OO<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">add-type
@"<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; using System.Net;<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; using
System.Security.Cryptography.X509Certificates;<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; public class TrustAllCertsPolicy :
ICertificatePolicy {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public bool CheckValidationResult(<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ServicePoint srvPoint,
X509Certificate certificate,<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WebRequest request, int certificateProblem)
{<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; }<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">"@<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">[System.Net.ServicePointManager]::CertificatePolicy
= New-Object TrustAllCertsPolicy<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">[Net.ServicePointManager]::SecurityProtocol
= [Net.SecurityProtocolType]::Ssl3, [Net.SecurityProtocolType]::Tls,
[Net.SecurityProtocolType]::Tls11, [Net.SecurityProtocolType]::Tls12<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Validates supplied OO content pack jar file <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">if
( -not (Test-Path "$PathToContentPackJarFile")) {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; throw 'File ' + $PathToContentPackJarFile +
' Does not exist'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}&nbsp; <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">elseif
(-not (Test-Path "$PathToContentPackJarFile" -PathType Leaf)){<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; throw $PathToContentPackJarFile + ' is not
a file'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">elseif
(($PathToContentPackJarFile.Substring($PathToContentPackJarFile.Length - 4))
-ne '.jar'){<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; throw $PathToContentPackJarFile + ' does
not have .jar extension'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}
<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Create authorization header value using supplied OO Central user name <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
and password. This authorization header value would be used in REST API <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
calls to OO Central Application.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$AuthPlainText
= $UserName + ':' + $Passwd<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$AuthPlainTextBytes
= [System.Text.Encoding]::UTF8.GetBytes($AuthPlainText)<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$AuthEncodedText
=[System.Convert]::ToBase64String($AuthPlainTextBytes)<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$AuthHeaderValue
= "Basic $AuthEncodedText"<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
OO requires cross reference token to be able to perform <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
create, delete or update operations.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Cross reference token from OO can be obtained by making a <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
GET REST API call to any one of the valid OO REST URIs.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Make a GET REST API call to OO and store session information.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$GetRequestURL
= $OOCentralURL + '/rest/v2/version'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">try{<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; $GetReqWebResponse = Invoke-WebRequest
-Method Get -Uri $GetRequestURL -Headers @{ 'Authorization' =
$AuthHeaderValue&nbsp; } -SessionVariable
'WebSession'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">catch{<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; If (IsNull($GetReqWebResponse)) {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw $($PSItem.ToString()) <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; }<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; else {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw 'Response code is ' +
$GetReqWebResponse.StatusCode + $($PSItem.ToString())<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; }<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">If
(IsNull($WebSession)) {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; throw 'Cannot open web session to the OO
Central Application'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Retrieve cross reference token cookie value from the web session<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
that was opened in GET call previously.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$Cookies
= $WebSession.Cookies.GetCookies($GetRequestURL) <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">If
(IsNull($Cookies)) {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; throw 'Unable to retrieve cookies from GET
request to OO Central Application'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">foreach
($cookie in $Cookies) { <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($($cookie.name) -eq
"X-CSRF-TOKEN-OO") {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $xcsrfToken = $($cookie.value)<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;
<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">If
(IsNull($xcsrfToken)) {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; throw 'X-CSRF-TOKEN-OO cookie is null or
empty'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Construct OO deployment URI using the supplied content pack name<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$deployURL
= $OOCentralURL + '/rest/v2/content-packs/' + $ContentPackName<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Form request headers to be used in a PUT call to deploy <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
content pack to OO Central Application.<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$headers
= @{<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; 'Content-Type' = 'application/octet-stream'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; 'accept' = 'application/json'<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; 'Authorization' = $AuthHeaderValue<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; 'X-CSRF-TOKEN' = $xcsrfToken<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
OO deploy content pack API requires that entire request body<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
consist of content of "OO content pack" jar file<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">$ooContentPackBytes
= [System.IO.File]::ReadAllBytes($PathToContentPackJarFile)<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Deploy OO Content Pack to OO Central Server by making a <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
PUT REST API call to OO<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">try{<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; $PutReqWebResponse = Invoke-WebRequest
-Method Put -Uri $deployURL -Headers $headers -Body $ooContentPackBytes
-WebSession $WebSession&nbsp; <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">catch{<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; # Something went wrong<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If (IsNull($PutReqWebResponse)) {<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw $($PSItem.ToString()) <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; }<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; else
{<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw 'Response code is ' +
$PutReqWebResponse.StatusCode + $($PSItem.ToString())<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; <o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><o:p><font face="Times New Roman">&nbsp;</font></o:p></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">#
Display response message from deploy content pack request to OO<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">If
(-Not (IsNull($PutReqWebResponse))){<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; $JSONResponse = ConvertFrom-Json -InputObject
$PutReqWebResponse.Content<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">&nbsp;&nbsp;&nbsp; Write-Host 'Response code:
'$PutReqWebResponse.StatusCode
':'$JSONResponse.contentPackResponses."$ContentPackName.jar".responses.message<o:p></o:p></font></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal"><font face="Times New Roman">}</font><span style="font-family:&quot;Courier New&quot;"><o:p></o:p></span></p></h1>