Micro Focus Operations Orchestration (OO) uses business intelligence available in a content pack to automate certain IT processes. Business intelligence inside a content pack is defined in the form of flows. A flow is the composition of steps and transitions forming a set of actions that are linked by decision-making logic in order to automate tasks. For example, health checks, troubleshooting, or any other repetitive IT support tasks. An OO flow has inputs and outputs. Flow takes inputs, performs tasks based on its inputs and generates output. Flows are designed and developed in Studio, Workflow Designer and then run in OO Central. A flow run is a single execution of a flow in OO Central.&nbsp; A flow is like a class definition in an object oriented programming language. A flow run or a flow execution is similar to instantiation of an object from a class definition.&nbsp;<div><br></div><div>A flow run or flow execution collects data and stores it in database. This flow run data is then visible in the OO Central UI.&nbsp; Every flow execution contributes to increase in database size as it stores data in the database. It is highly recommended to purge flow execution data periodically to maintain optimal performance of Operations Orchestration. Use the following ways to purge database on a recurring basis:<br></div><div><ol><li>Micro Focus supplied database maintenance scripts.<br></li><li>Micro Focus supplied purging flows which are available in the solutions content pack.&nbsp;<br></li></ol><div>This article shows a power shell script that can be used to purge flow execution data on-demand. Here are some of the script use cases and caveats:<br></div></div><div><br></div><div><b>Script use cases</b><br></div><div><div style=""><ul><li>Use this script to purge flow execution data as required.</li><li>Sometimes, developers may forget to hide sensitive information such as passwords in an OO flow. Use this script to immediately remove flow execution data containing sensitive information. This helps prevent others from seeing sensitive information in OO Central UI.</li><li>Use this script to selectively purge execution data for certain flows.</li></ul><div><br></div><div><b>Script caveats</b></div><div><div style=""><ul><li>Use caution when running this script. This script purges flow execution data and cannot be recovered unless you have a database backup.</li><li>Do not use this script to perform mass purge of flow execution data.</li><li>Do not schedule this script to purge flow execution data on a recurring basis. Instead, use Micro Focus supported database maintenance purge scripts and purging flows in the solution content pack. This script is not meant to replace Micro Focus supported database maintenance purge scripts and purging flows in the solutions content pack.</li></ul><div><br></div><div>This script can be further enhanced to meet your coding style, perform additional checks required for your environment, to improve performance, to use as a reference to develop it in your preferred programming language, to use as a reference to make other OO REST API calls, etc. At a high level, this script performs the following:<br></div><div><div><ul><li>Validates input values.&nbsp;</li><li>Purges flow execution data based on the filters supplied via command line parameters.</li></ul><div><br></div><div>To run this script, follow the steps below:<br></div></div></div><div><div><ol><li>Log on to a system running windows operating system.</li><li>Open a text editor.&nbsp;</li><li>Copy contents of this script to the text editor. Save the file as “OOPurgeFlowExecHistory.ps1”.</li><li>Open windows power shell. Navigate to the directory containing this power shell script.</li><li>Run the “OOPurgeFlowExecHistory.ps1” powershell script as follows: <br>.\OOPurgeFlowExecHistory.ps1 -OOCentralURL https://&lt;OOCentralHostName&gt;:&lt;Port&gt;/oo -UserName admin -Passwd &lt;AdminPassword&gt; -BeforeDateUTC "08-20-2019 02:01:09" -MaxExecPurge 200 -PurgeItemTypes "flowInputs,flowOutputs" -Statuses "COMPLETED_RESOLVED,COMPLETED_ERROR" -FlowUUIDs "434e6fa2-26bc-4e84-9e1f-0aa6946cf920,434e6fa2-26bc-4e84-9e1f-0aa6946cf921"</li><li>Use “OOCentralURL”, “UserName” and “Passwd” parameters to connect to the OO Central Application. The “OOCentralURL”, “UserName” and “Passwd” parameters are mandatory.</li><li>Use “BeforeDateUTC” parameter to purge flow execution data prior to certain date and time in UTC. The “BeforeDateUTC” parameter value must be in the following format: “MM-DD-YYYY HH24:MI:SS”. The “BeforeDateUTC” parameter is optional. If no value is specified, script uses current date and time as the default value for this parameter.</li><li>Use “MaxExecPurge” parameter to restrict amount of flow execution data that would be purged. The “MaxExecPurge” parameter is optional. If no value is specified, script uses default value of 100 for “MaxExecPurge” parameter.</li><li>Use “PurgeItemTypes” parameter to delete specific item types from flow execution data. Valid values for “PurgeItemTypes” parameter are as follows: flowInputs, flowOutputs, steps, runningExecutionPlans, and runningExecutionConfigurations. You can specify multiple purge item types separated by a comma character, enclosed in double quotes. PurgeItemTypes parameter is optional. If no value is specified, script purges all item types listed above for flow executions including execution summary.</li><li>Use “Statuses” parameter to purge flow executions that are in a specific status. Valid values for “Statuses” parameter are as follows: COMPLETED, COMPLETED_RESOLVED, COMPLETED_DIAGNOSED, COMPLETED_ERROR, COMPLETED_NO_ACTION_TAKEN, COMPLETED_CUSTOM, SYSTEM_FAILURE and CANCELED.&nbsp; You can specify multiple statuses separated by a comma character, enclosed in double quotes. Statuses parameter is optional. If no value is specified, script purges flow executions that are in any of the statuses listed above.</li><li>Use “FlowUUIDs” parameter to purge flow executions that are run from specific flows. You can specify multiple flow UUIDs separated by a comma character, enclosed in double quotes. By default, a maximum of 5 flow UUIDs can be specified at a time. To specify more than 5 flow UUIDs at a time, change value for the “MAX_FLOWUUIDS_DEFAULT” variable in the script. FlowUUIDs parameter is optional. If no value is specified, script purges flow executions for all flows.</li></ol><div><b>Examples</b></div></div></div><div><div><ol><li>To purge history for up to 100 flow executions that were run before current date and time, run the script as follows:&nbsp;<span style="background-color: transparent;"> <br>.\OOPurgeFlowExecHistory.ps1 -OOCentralURL https://&lt;OOCentralHostName&gt;:&lt;Port&gt;/oo -UserName admin -Passwd &lt;AdminPassword&gt;</span></li><li>To purge history for up to 200 flow executions that were run before August 20th 2019 2 AM UTC, run the script as follows:&nbsp;<span style="background-color: transparent;"> <br>.\OOPurgeFlowExecHistory.ps1 -OOCentralURL https://&lt;OOCentralHostName&gt;:&lt;Port&gt;/oo -UserName admin -Passwd &lt;AdminPassword&gt; -BeforeDateUTC "08-20-2019 02:00:00" -MaxExecPurge 200</span></li><li>To purge history for up to 100 flow executions from a particular flow and that were run before current date and time, run the script as follows:&nbsp;<span style="background-color: transparent;"><br>.\OOPurgeFlowExecHistory.ps1 -OOCentralURL https://&lt;OOCentralHostName&gt;:&lt;Port&gt;/oo -UserName admin -Passwd &lt;AdminPassword&gt; -FlowUUIDs 434e6fa2-26bc-4e84-9e1f-0aa6946cf920</span></li><li>To purge history for up to 100 flow executions from a particular flow, that were run before current date and time and that are in either CANCELED or COMPLETED_ERROR state, run the script as follows:&nbsp;<span style="background-color: transparent;"><br>.\OOPurgeFlowExecHistory.ps1 -OOCentralURL https://&lt;OOCentralHostName&gt;:&lt;Port&gt;/oo -UserName admin -Passwd &lt;AdminPassword&gt; -FlowUUIDs 434e6fa2-26bc-4e84-9e1f-0aa6946cf920 -Statuses "CANCELED,COMPLETED_ERROR"</span></li><li>To purge flow input and flow output history for up to 100 flow executions, that were run before current date and time, run the script as follows:&nbsp;<span style="background-color: transparent;"><br>.\OOPurgeFlowExecHistory.ps1 -OOCentralURL https://&lt;OOCentralHostName&gt;:&lt;Port&gt;/oo -UserName admin -Passwd &lt;AdminPassword&gt; -PurgeItemTypes "flowInputs,flowOutputs"</span></li></ol></div></div><div><br></div></div></div></div></div>